# Tasks

- young_station_reached if age <= 20 *)
- Make sure handling of money is complete
  - Possible remove other /2 places
- Can't enter stock broker after load
  - Has to do with pause state getting messed up after load
- Can keep building into minus
- Rivers at land edge don't look good
- Harbors near river should be closed in
- AI now established too early?
- Upgrade bridge only when over bridge
- Sound wip. Missing:
  - Honk on leaving back rail in station report/creation of train
  - Regular bell on train leaving station
  - Honk when quit
  - Audio for animations
- Handle > 32 trains with some visual display
  - arrows?
  - scroll bar?
- Handle updgradegbridge
- Handle display menu options
- Handle repeate message
- Selecting zoom with mouse opens msgbox to choose center
- Animate zoom transition
- For playback, use list of variants, not the current system
  - Deletions mess it up
- Can't build within 5 of enemy station
- Rate war:
  - can't build facilities
- Start menu:
  - See if we can support the original menu colors (use menu images from original)
  - Make menu highlight go all the way (solved by same solution)
  - Select default value
- History: does it include anything from the current period?
  - No
- History depends on a lot of present data being relevant for past. Check.
  - e.g. company being dissolved.
  - We can do a much cleaner job with dedicated history stuff.
- Efficiency Report: check difference between ton-miles delivered and ton-miles traveled
- Train income: check multiple pages of trains work well
- Why divide lifetime train money by 2? Makes some sense for 2-year fiscal period, but lifetime?
- Check that activegstation only works for 20 years per station
- Move block_map and track_graph to player?
- Can't rebuild bridge under repair
- Allow upgrading station while keeping station data
- Stock broker: print ownership of AI stock
- Way we changed random things (e.g. track maintenance) isn't right
  - Need to scale up to more track than 100% of original game
- Check default state of development_map and block_map
- What happens when we delete a station and a train is heading there?
- Check computation of wait time
- cursor fix?
  - software cursor?
- Check if we actually need to loop in _update_train (print out if we ever do multiple updates)
  - I think we do for high speeds
- Update_train: handle freight class priority movement
  - Data structure sorted by priority?
- New stations should have double rates for one fiscal period.
- New train should ask where we want to build
- Handle upgrade bridge - make sure
- Center on event (bridge washout)
- Accomplishments multiple pages
- Operate_rr_take_money/give_money
  - Check if need to update ai valuation
- Trackmap remove_track: do we need to handle ixn in Track _ | Ferry _ ?

- Bug:
  - Cannot buy AI stock (nothing happens)
  - Train shows Passenger3 on delivery
  - Income statement weird
   - Expenses are low but get to 600k somehow (what's counting there?)
   - Leads to negative
  - Train income:
    - Revenue ytd not updating properly
  - Stocks view causes crash (because we add too many AI players)
  - Speed too slow (fast not fast enough)
  - Bonus from priority delivery doesn't go away after delivery
  - Bonus too high for distance
  - Bonus added to money too high (maybe not decremented)
  - AI Companies dissolve after one fin period
  - turbo doesn't seem so fast
  - trains don't take turns on semaphores
  - setting speed doesn't unpause menu
  - Build station before track: send notification that need track first
  - Speed record set too easily
  - Dismiss build train animation with enter
  - Station resource window doesn't appear when station close to edge of window.
  - Year doesn't switch at end of December.
    - May be in original game too
  - Fiscal end stock eval: msgbox weird size thing
  - 2 stations: 1 station not being delivered to?
  - B and P in priority shipment are off left by one
  - Station screen has name in wrong place
  - Can't upgrade station to new station
  - Animation: minor bugs remain
    - e.g. missing left train in title
  - Delivery + priority pickup: no delivery message
  - Can't change station light from f2/f3
  - Create a train with no station: msgbox to build a station first
  - Where does smoke originate? Check in code.
  - Smoke seems to go in different direction from game
  - joining a track from another track either refuses or crashes
  - Going into negative should be red money
    I think fixed
  - Consider not painting tilebuffer every render of zoom3/2
 
- Post 1.0
  - Add maps from Deluxe
  - Supporting hi-res might involve making a proper UI system
    - Or just scale modal windows somewhat
    - windows holding widgets with focus
    - can be laid out properly
    - can hold current menu/msgbox stuff

